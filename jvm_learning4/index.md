# JVM 学习4


## 栈基本概念
* 一种先进后出的数据结构与队列相对  
* 栈内存，主管程序的运行
* 生命周期与线程同步，线程结束，栈内存也就释放了
* 对于栈内存来说，不存在垃圾回收机制

## 执行是栈内存的执行情况
![](/image_JVM/pic5.png)
![](/image_JVM/pic6.png)
* 首先main方法压栈
* main中调用test方法，test压栈
* test执行完后出栈
* main执行完后出栈，整个程序执行完成

## 栈内存溢出错误
![](/image_JVM/pic7.png)
* test 方法 和 a方法两者之间递归调用
* 无法停止，说明在不停地向占内存中压栈，耗尽栈内存空间，导致栈内存溢出（StackOverflowError）

## 栈内存放的数据
* 八大基本类型
* 对象的引用
* 实例的方法

## 栈运行原理 
![](/image_JVM/pic8.png)
* 每一个执行的方法都会产生一个栈帧
* 程序正在执行的方法永远在栈顶
* stack1 和 stack2均为一个栈帧
* 每一个栈帧内部都存放着数据

## 栈、堆、方法区的交互关系
_关键：绿色为栈内存，浅蓝色为堆内存，红色为方法区，蓝色为常量池，白色为通过编译的class文件_   
![](/image_JVM/pic9.png)
* new一个对象时，加一个引用到栈的一个栈帧里
* 栈里还包括其他存放数据
* new的对象数据存放在堆内存中，通过栈中的引用找到
* 堆中对象所包含的常量去方法区中的常量池寻找




